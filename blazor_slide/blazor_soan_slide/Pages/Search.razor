@page "/search"
@inject NavigationManager Navigation
@layout HomePageMaster


<h3>Search Results for: "@searchTerm"</h3>
<EditForm class="d-flex my-2 my-lg-0" EditContext="editContext" OnSubmit="HandleSubmit">
    <input class="form-control me-sm-2" type="text" placeholder="Search" @bind-value="keyword" />
    <button class="btn btn-outline-success my-2 my-sm-0" type="submit">
        Search
    </button>
</EditForm>
@code {
    private string searchTerm;
    private string keyword { get; set; }
    private EditContext editContext;

    protected override void OnInitialized()
    {
        // Khởi tạo EditContext với một đối tượng dynamic hoặc new object()
        editContext = new EditContext(new object());
        searchByKeyword();
    }
     private async Task HandleSubmit(){
        Navigation.NavigateTo($"/search?k={keyword}");  
    }
    protected override void searchByKeyword()
    {
        // Lấy giá trị query parameter từ URL
        var uri = new Uri(Navigation.Uri);
        var query = Microsoft.AspNetCore.WebUtilities.QueryHelpers.ParseQuery(uri.Query);

        if (query.TryGetValue("k", out var searchParam))
        {
            searchTerm = searchParam;
        }

    }


}
